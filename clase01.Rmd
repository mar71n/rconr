---
title: "Clase 01"
output: html_document
#date: '2022-05-30'
knit: (function(inputFile, encoding) {
  out_dir <- 'docs';
  rmarkdown::render(inputFile,
                    encoding="UTF-8",
                    output_file=file.path(dirname(inputFile), out_dir, 'clase01.html')) })
---

```{r klippy, echo=FALSE, include=TRUE}
klippy::klippy('')
```

```
Instalación, ayuda, búsquedas:
R, CRAN, R-seek, RStudio, install.packages, library
Variables y tipos, importar datos:
vectores, matrices, factores, list, asignación
dataframe, tibles
```

Una versión actualizada de este material en : [clase01](https://mar71n.github.io/rconr/clase01.html)

---

## Instalar:

### Página principal de R:
- [https://www.r-project.org/](https://www.r-project.org/)

- Descargas o CRAN lleva a : [https://cran.r-project.org/mirrors.html](https://cran.r-project.org/mirrors.html)

- Donde vemos una lista de "mirrors".

- De Argentina : El de la [Facultad de Ciencias Astronómicas y Geofísicas - UNLP](https://www.fcaglp.unlp.edu.ar/)

http://mirror.fcaglp.unlp.edu.ar/CRAN/

- O uno general https://cloud.r-project.org/ que de alguna manera elije entre los disponibles.

Descargamos el instalador para el SO y arquitectura correspondiente.


### Rtools :
Para algunas instalaciones de paquetes en Windows

- para R4.2:
[https://cran.r-project.org/bin/windows/Rtools/rtools42/rtools.html](https://cran.r-project.org/bin/windows/Rtools/rtools42/rtools.html)

- para R3.6 o menos :
[https://cran.r-project.org/bin/windows/Rtools/history.html](https://cran.r-project.org/bin/windows/Rtools/history.html)


### Tidyverse :
- [www.tidyverse.org](https://www.tidyverse.org/packages/)

### Rstudio :
- [www.rstudio.com](https://www.rstudio.com/)
- [www.rstudio.com/products/rstudio/download/](https://www.rstudio.com/products/rstudio/download/)

***

### Búsquedas y ayuda :

- [https://rseek.org/](https://rseek.org/)

- [https://www.rdocumentation.org/](https://www.rdocumentation.org/)

- [https://community.rstudio.com/](https://community.rstudio.com/)

- [versión en español de Stack Overflow](https://es.stackoverflow.com/)

***
***

## Variables y tipos, importar algunos datos:

```{r, echo=TRUE,  class.source='klippy'}
typeof(1.2)

typeof(1L)

typeof("abc")

typeof(TRUE)

typeof(2+1i)

```

#### Con los tipos numéricos, R es una "calculadora"

```{r, echo=TRUE,  class.source='klippy'}
# Suma
15 + 35 

# Resta
50 - 35 

# Multiplicación
3 * 5

# Division
(15 + 35) / 2 

# Potencia
2^8

# Division
29 / 6

# Division entera
29 %/% 6

# Modulo o resto
29 %% 6
```

#### Puedo usar variables :

```{r, echo=TRUE,  class.source='klippy'}
precio_anterior = 85.23
precio_actual = 99.0
diferencia = precio_actual - precio_anterior
# Que % aumento ? (del precio inicial)
diferencia / precio_anterior * 100
((precio_actual / precio_anterior) - 1) * 100
```
#### Lo puedo poner en una funcion : 

```{r, echo=TRUE,  class.source='klippy'}
aumento <- function(x, y){
  (y - x) / x * 100
}

aumento(precio_anterior, precio_actual)
```

***
***

## Vectores

```{r, echo=TRUE,  class.source='klippy'}
c(1, 4, 7, 3)

c("a", "23", "abc")

c(TRUE, FALSE, FALSE, TRUE)
```


```{r, echo=TRUE,  class.source='klippy'}
precios_enero <- c(100, 600, 20000, 45)
precios_marzo <- c(110, 650, 21000, 45)

total_enero <- sum(precios_enero)
total_marzo <- sum(precios_marzo)

aumento(total_enero, total_marzo)

precios_marzo - precios_enero

aumento(precios_enero, precios_marzo)
```

***
***

### Algunos datasets
#### data.frame

```{r, echo=TRUE,  class.source='klippy'}
barrios <- read.csv("https://cdn.buenosaires.gob.ar/datosabiertos/datasets/barrios/barrios.csv", encoding = "UTF-8")

poblacion <- read.csv("https://cdn.buenosaires.gob.ar/datosabiertos/datasets/barrios/caba_pob_barrios_2010.csv", encoding = "UTF-8")

comunas <- read.csv("https://cdn.buenosaires.gob.ar/datosabiertos/datasets/comunas/comunas.csv", encoding = "UTF-8")

names(barrios)

str(barrios)

summary(barrios)

library(dplyr)

barrios %>% select(barrio, comuna)

barrios %>% select(!WKT)

names(comunas)

str(comunas)

names(poblacion)

str(poblacion)

comunas %>% select(COMUNAS, BARRIOS)

library(ggplot2)
library(sf)

ggplot(barrios) +
  geom_bar(aes(x = barrio, weight = area)) +
             coord_flip()

ggplot(barrios %>% select(barrio, area)) +
  geom_bar(aes(x = reorder(barrio, area), weight = area)) +
  coord_flip()


write.csv(barrios, "datos/barrios.csv", row.names = FALSE)

barrios2 <- st_read("datos/barrios.csv")

ggplot(barrios2) + 
  geom_sf(aes(fill=comuna))
```
